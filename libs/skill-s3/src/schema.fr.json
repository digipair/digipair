{
  "openapi": "3.0.0",
  "info": {
    "title": "@digipair/skill-s3",
    "summary": "Gestionnaire de fichiers S3",
    "description": "Manipulez des fichiers sur AWS S3 (envoi, t√©l√©chargement, suppression, liste)",
    "version": "0.1.0",
    "x-icon": "üóÇÔ∏è"
  },
  "paths": {
    "/upload": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Envoyer un fichier",
        "description": "Envoie un fichier dans un bucket S3",
        "parameters": [
          {
            "name": "bucket",
            "summary": "Nom du bucket",
            "required": true,
            "description": "Nom du bucket S3 cible",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "key",
            "summary": "Cl√© de l'objet",
            "required": true,
            "description": "Cl√© (chemin) sous laquelle le fichier sera stock√©",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "content",
            "summary": "Contenu en base64",
            "required": true,
            "description": "Contenu encod√© en base64 du fichier (avec pr√©fixe data URI)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "config",
            "summary": "Configuration AWS",
            "required": false,
            "description": "Configuration du client AWS SDK (optionnelle)",
            "schema": {
              "type": "object"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "R√©ponse AWS S3 PutObjectCommand",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ETag": {
                      "type": "string",
                      "description": "√âtiquette d'entit√© pour l'objet t√©l√©charg√©"
                    },
                    "ServerSideEncryption": {
                      "type": "string",
                      "description": "Chiffrement c√¥t√© serveur utilis√©"
                    },
                    "VersionId": {
                      "type": "string",
                      "description": "ID de version de l'objet (si le versioning est activ√©)"
                    },
                    "SSECustomerAlgorithm": {
                      "type": "string",
                      "description": "Algorithme de chiffrement fourni par le client"
                    },
                    "SSECustomerKeyMD5": {
                      "type": "string",
                      "description": "MD5 digest de la cl√© de chiffrement fournie par le client"
                    },
                    "SSEKMSKeyId": {
                      "type": "string",
                      "description": "ID de cl√© AWS KMS utilis√© pour le chiffrement"
                    },
                    "BucketKeyEnabled": {
                      "type": "boolean",
                      "description": "Indique si la cl√© de bucket est activ√©e"
                    },
                    "RequestCharged": {
                      "type": "string",
                      "description": "Indicateur de facturation de la requ√™te"
                    }
                  }
                }
              }
            }
          }
        },
        "x-events": []
      }
    },
    "/download": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "T√©l√©charger un fichier",
        "description": "T√©l√©charge un fichier depuis un bucket S3",
        "parameters": [
          {
            "name": "bucket",
            "summary": "Nom du bucket",
            "required": true,
            "description": "Nom du bucket S3",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "key",
            "summary": "Cl√© de l'objet",
            "required": true,
            "description": "Cl√© (chemin) du fichier √† t√©l√©charger",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "range",
            "summary": "Plage de contenu",
            "required": false,
            "description": "La plage de contenu du fichier √† t√©l√©charger",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "config",
            "summary": "Configuration AWS",
            "required": false,
            "description": "Configuration du client AWS SDK (optionnelle)",
            "schema": {
              "type": "object"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Fichier t√©l√©charg√© en data URL base64",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Contenu du fichier en data URL base64 avec type MIME"
                }
              }
            }
          }
        },
        "x-events": []
      }
    },
    "/delete": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Supprimer un fichier",
        "description": "Supprime un fichier d‚Äôun bucket S3",
        "parameters": [
          {
            "name": "bucket",
            "summary": "Nom du bucket",
            "required": true,
            "description": "Nom du bucket S3",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "key",
            "summary": "Cl√© de l'objet",
            "required": true,
            "description": "Cl√© (chemin) du fichier √† supprimer",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "config",
            "summary": "Configuration AWS",
            "required": false,
            "description": "Configuration du client AWS SDK (optionnelle)",
            "schema": {
              "type": "object"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "R√©ponse AWS S3 DeleteObjectCommand",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "DeleteMarker": {
                      "type": "boolean",
                      "description": "Si un marqueur de suppression a √©t√© cr√©√©"
                    },
                    "VersionId": {
                      "type": "string",
                      "description": "ID de version du marqueur de suppression"
                    },
                    "RequestCharged": {
                      "type": "string",
                      "description": "Indicateur de facturation de la requ√™te"
                    }
                  }
                }
              }
            }
          }
        },
        "x-events": []
      }
    },
    "/list": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Lister les fichiers",
        "description": "Liste les fichiers d‚Äôun bucket S3, avec un pr√©fixe √©ventuel",
        "parameters": [
          {
            "name": "bucket",
            "summary": "Nom du bucket",
            "required": true,
            "description": "Nom du bucket S3",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "prefix",
            "summary": "Pr√©fixe",
            "required": false,
            "description": "Pr√©fixe (dossier) pour filtrer les objets",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "config",
            "summary": "Configuration AWS",
            "required": false,
            "description": "Configuration du client AWS SDK (optionnelle)",
            "schema": {
              "type": "object"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "R√©ponse AWS S3 ListObjectsV2Command",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "IsTruncated": {
                      "type": "boolean",
                      "description": "Si la r√©ponse est tronqu√©e"
                    },
                    "Contents": {
                      "type": "array",
                      "description": "Liste des objets dans le bucket",
                      "items": {
                        "type": "object",
                        "properties": {
                          "Key": {
                            "type": "string",
                            "description": "Cl√© de l'objet (chemin)"
                          },
                          "LastModified": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Date de derni√®re modification"
                          },
                          "ETag": {
                            "type": "string",
                            "description": "√âtiquette d'entit√©"
                          },
                          "Size": {
                            "type": "number",
                            "description": "Taille de l'objet en octets"
                          },
                          "StorageClass": {
                            "type": "string",
                            "description": "Classe de stockage"
                          },
                          "Owner": {
                            "type": "object",
                            "description": "Informations sur le propri√©taire de l'objet"
                          }
                        }
                      }
                    },
                    "Name": {
                      "type": "string",
                      "description": "Nom du bucket"
                    },
                    "Prefix": {
                      "type": "string",
                      "description": "Pr√©fixe utilis√© pour le filtrage"
                    },
                    "MaxKeys": {
                      "type": "number",
                      "description": "Nombre maximum de cl√©s retourn√©es"
                    },
                    "KeyCount": {
                      "type": "number",
                      "description": "Nombre de cl√©s retourn√©es"
                    },
                    "ContinuationToken": {
                      "type": "string",
                      "description": "Token de pagination"
                    },
                    "NextContinuationToken": {
                      "type": "string",
                      "description": "Token de continuation suivant pour la pagination"
                    }
                  }
                }
              }
            }
          }
        },
        "x-events": []
      }
    }
  },
  "components": {
    "schemas": {}
  }
}