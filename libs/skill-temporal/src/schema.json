{
  "openapi": "3.0.0",
  "info": {
    "title": "@digipair/skill-temporal",
    "summary": "Temporal workflow management",
    "description": "This skill allows managing temporal workflows",
    "version": "0.1.0",
    "x-icon": "üë©‚Äçüíª"
  },
  "paths": {
    "/activity": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Activity",
        "description": "Defines an activity",
        "parameters": [
          {
            "name": "name",
            "summary": "Name",
            "required": false,
            "description": "Name of the step",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "execute",
            "summary": "Execute",
            "required": true,
            "description": "List of actions to execute",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "https://schemas.digipair.ai/pinsSettings"
              }
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Activity execution result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Result of the activity execution"
                }
              }
            }
          }
        }
      }
    },
    "/sleep": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Wait",
        "parameters": [
          {
            "name": "name",
            "summary": "Name",
            "required": false,
            "description": "Name of the step",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "duration",
            "summary": "Duration",
            "required": true,
            "description": "Duration of the wait",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Sleep duration confirmation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Confirmation that sleep duration has been applied"
                }
              }
            }
          }
        }
      }
    },
    "/condition": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Wait condition",
        "description": "Wait condition in a workflow",
        "parameters": [
          {
            "name": "condition",
            "summary": "Condition",
            "required": true,
            "description": "Wait condition in Feel format",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "timeout",
            "summary": "Timeout",
            "required": false,
            "description": "Timeout of the condition",
            "schema": {
              "type": "number"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Wait condition result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "boolean",
                  "description": "Whether the condition was met before timeout"
                }
              }
            }
          }
        }
      }
    },
    "/goto": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Go to step",
        "parameters": [
          {
            "name": "target",
            "summary": "Destination name",
            "required": true,
            "description": "Name of the destination step",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "summary": "Name",
            "required": false,
            "description": "Name of the step",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Step number after goto",
            "content": {
              "application/json": {
                "schema": {
                  "type": "number",
                  "description": "Target step number in the workflow"
                }
              }
            }
          }
        }
      }
    },
    "/stop": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Stop the workflow",
        "description": "Stop the workflow",
        "parameters": [
          {
            "name": "name",
            "summary": "Name",
            "required": false,
            "description": "Name of the step",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Workflow stop confirmation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "null",
                  "description": "Workflow has been stopped"
                }
              }
            }
          }
        }
      }
    },
    "/push": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Send new data to a workflow",
        "description": "Send new data to the workflow",
        "parameters": [
          {
            "name": "id",
            "summary": "Workflow ID",
            "required": true,
            "description": "Workflow ID",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "data",
            "summary": "Data",
            "required": true,
            "description": "Data",
            "schema": {
              "type": "object"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Data push confirmation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "null",
                  "description": "Data has been successfully pushed to the workflow"
                }
              }
            }
          }
        }
      }
    },
    "/terminate": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Stop a workflow",
        "description": "Stop a workflow",
        "parameters": [
          {
            "name": "id",
            "summary": "Workflow ID",
            "required": true,
            "description": "Workflow ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Workflow termination confirmation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "null",
                  "description": "Workflow has been successfully terminated"
                }
              }
            }
          }
        }
      }
    },
    "/list": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "List workflows",
        "description": "List workflows",
        "parameters": [
          {
            "name": "query",
            "summary": "Query",
            "required": false,
            "description": "Search query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "List of workflows",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/WorkflowExecutionInfo"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "WorkflowExecutionInfo": {
        "tags": [],
        "type": "object",
        "description": "Information about a Temporal workflow execution",
        "properties": {
          "workflowId": {
            "type": "string",
            "description": "Unique identifier of the workflow"
          },
          "runId": {
            "type": "string",
            "description": "Unique identifier of the workflow run"
          },
          "type": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the workflow type"
              }
            }
          },
          "status": {
            "type": "string",
            "enum": [
              "Running",
              "Completed",
              "Failed",
              "Cancelled",
              "Terminated"
            ],
            "description": "Current status of the workflow"
          },
          "startTime": {
            "type": "string",
            "format": "date-time",
            "description": "When the workflow was started"
          },
          "taskQueue": {
            "type": "string",
            "description": "Task queue name used by the workflow"
          }
        }
      }
    }
  },
  "x-scene-blocks": {
    "/workflow": {
      "summary": "Temporal Workflow",
      "description": "Execute a Temporal workflow",
      "tags": [
        "service"
      ],
      "metadata": [],
      "parameters": [
        {
          "name": "id",
          "summary": "ID",
          "required": true,
          "description": "Workflow ID",
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "steps",
          "summary": "Execute the following steps",
          "required": true,
          "description": "Content of the page",
          "schema": {
            "type": "array",
            "items": {
              "$ref": "https://schemas.digipair.ai/pinsSettings"
            }
          }
        },
        {
          "name": "data",
          "summary": "Workflow data",
          "required": false,
          "description": "Temporal workflow data",
          "schema": {
            "type": "object"
          }
        },
        {
          "name": "options",
          "summary": "Temporal options",
          "required": false,
          "description": "Temporal workflow options",
          "schema": {
            "type": "object"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Workflow execution result",
          "content": {
            "application/json": {
              "schema": {
                "description": "The result of the last executed step in the workflow"
              }
            }
          }
        }
      }
    }
  }
}