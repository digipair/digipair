{
  "openapi": "3.0.0",
  "info": {
    "title": "@digipair/skill-logger",
    "summary": "Gestion des logs et de la consommations LLM",
    "description": "Gestion des logs et de la consommations LLM",
    "version": "0.1.0",
    "x-icon": "üî¢"
  },
  "paths": {
    "/read": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Logs",
        "description": "Lecture des logs d'un jour donn√©",
        "parameters": [
          {
            "name": "date",
            "summary": "Date",
            "required": true,
            "description": "Date des logs",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "summary": "Type de logs",
            "required": false,
            "description": "Type de logs √† lire (factory, consumption-daily, consumption-monthly)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "path",
            "summary": "Chemin d'acc√®s",
            "required": false,
            "description": "Chemins d'acc√®s du r√©pertoire Digipair",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Entr√©es de logs pour la date et le type sp√©cifi√©s",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LogEntry"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/list": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Liste des jours de logs",
        "description": "Liste les jours logs",
        "parameters": [
          {
            "name": "type",
            "summary": "Type de logs",
            "required": false,
            "description": "Type de logs √† lister (factory, consumption-daily, consumption-monthly)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "path",
            "summary": "Chemin d'acc√®s",
            "required": false,
            "description": "Chemins d'acc√®s du r√©pertoire Digipair",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Liste des dates de logs disponibles",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "description": "Cha√Æne de date au format YYYY-MM-DD"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/computeDailyConsumption": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Calcul et sauvegarde de la consommation journali√®re",
        "description": "Calcul et sauvegarde de la consommation journali√®re dans le fichier de consommation mensuelle LLM",
        "parameters": [
          {
            "name": "date",
            "summary": "Date",
            "required": true,
            "description": "Date du jour de la consommation LLM √† ajouter dans le fichier de consommation mensuelle",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "path",
            "summary": "Chemin d'acc√®s",
            "required": false,
            "description": "Chemins d'acc√®s du r√©pertoire Digipair",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Calcul de la consommation journali√®re termin√©",
            "content": {
              "application/json": {
                "schema": {
                  "type": "null",
                  "description": "Op√©ration termin√©e avec succ√®s"
                }
              }
            }
          }
        }
      }
    },
    "/cleaning": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Efface les anciens logs",
        "description": "Efface les anciens fichiers de logs",
        "parameters": [
          {
            "name": "to",
            "summary": "Jusqu'√†",
            "required": true,
            "description": "Date jusqu'√† laquelle les logs doivent √™tre conserv√©s",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "type",
            "summary": "Type de logs",
            "required": false,
            "description": "Type de logs √† effacer (factory, consumption-daily, consumption-monthly)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "path",
            "summary": "Chemin d'acc√®s",
            "required": false,
            "description": "Chemins d'acc√®s du r√©pertoire Digipair",
            "schema": {
              "type": "string"
            }
          }
        ],
        "x-events": [],
        "responses": {
          "200": {
            "description": "Nettoyage des anciens logs termin√©",
            "content": {
              "application/json": {
                "schema": {
                  "type": "null",
                  "description": "Op√©ration termin√©e avec succ√®s"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "LogEntry": {
        "tags": [],
        "type": "object",
        "description": "Objet d'entr√©e de log",
        "properties": {
          "date": {
            "type": "number",
            "description": "Horodatage de l'entr√©e de log"
          },
          "digipair": {
            "type": "string",
            "description": "Identifiant du digipair"
          },
          "reasoning": {
            "type": "string",
            "description": "Identifiant du raisonnement"
          },
          "type": {
            "type": "string",
            "description": "Type d'entr√©e de log (info, error, warning, etc.)"
          },
          "message": {
            "type": "string",
            "description": "Message du log"
          },
          "service": {
            "type": "string",
            "description": "Nom du service (pour les logs de consommation)"
          },
          "model": {
            "type": "string",
            "description": "Nom du mod√®le (pour les logs de consommation)"
          },
          "promptTokens": {
            "type": "number",
            "description": "Nombre de tokens de prompt (pour les logs de consommation)"
          },
          "completionTokens": {
            "type": "number",
            "description": "Nombre de tokens de compl√©tion (pour les logs de consommation)"
          }
        },
        "required": [
          "date",
          "digipair",
          "reasoning"
        ]
      }
    }
  }
}