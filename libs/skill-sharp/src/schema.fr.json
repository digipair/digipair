{
  "openapi": "3.0.0",
  "info": {
    "title": "@digipair/skill-sharp",
    "summary": "Traitement d‚Äôimage",
    "description": "Cette skill permet d‚Äôeffectuer des traitements avanc√©s sur les images gr√¢ce √† la librairie Sharp.",
    "version": "0.1.0",
    "x-icon": "üñºÔ∏è"
  },
  "paths": {
    "/metadata": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "M√©tadonn√©es",
        "description": "Retourne les m√©tadonn√©es de l‚Äôimage (dimensions, format, EXIF, etc.).",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "description": "Image encod√©e en base64",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Objet des m√©tadonn√©es de l'image",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "width": {
                      "type": "number",
                      "description": "Largeur de l'image en pixels"
                    },
                    "height": {
                      "type": "number",
                      "description": "Hauteur de l'image en pixels"
                    },
                    "channels": {
                      "type": "number",
                      "description": "Nombre de canaux de couleur"
                    },
                    "format": {
                      "type": "string",
                      "description": "Format de l'image (jpeg, png, webp, etc.)"
                    },
                    "space": {
                      "type": "string",
                      "description": "Espace colorim√©trique (srgb, rgb16, cmyk, etc.)"
                    },
                    "density": {
                      "type": "number",
                      "description": "Densit√© de l'image en pixels par pouce"
                    },
                    "hasProfile": {
                      "type": "boolean",
                      "description": "Si l'image a un profil de couleur int√©gr√©"
                    },
                    "hasAlpha": {
                      "type": "boolean",
                      "description": "Si l'image a un canal alpha"
                    }
                  }
                    "width": 1920,
                  "height": 1080,
                  "channels": 3,
                  "format": "jpeg",
                  "space": "srgb",
                  "density": 72,
                  "hasProfile": false,
                  "hasAlpha": false
                }
              }
            }
          }
        }
      }
    }
  },
  "/stats": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Statistiques",
      "description": "Retourne des statistiques sur l‚Äôimage comme la moyenne ou l‚Äô√©cart-type.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Objet de statistiques de l'image",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "channels": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "min": {
                          "type": "number",
                          "description": "Valeur de pixel minimale"
                        },
                        "max": {
                          "type": "number",
                          "description": "Valeur de pixel maximale"
                        },
                        "sum": {
                          "type": "number",
                          "description": "Somme de toutes les valeurs de pixels"
                        },
                        "squaresSum": {
                          "type": "number",
                          "description": "Somme des valeurs de pixels au carr√©"
                        },
                        "mean": {
                          "type": "number",
                          "description": "Valeur moyenne des pixels"
                        },
                        "stdev": {
                          "type": "number",
                          "description": "√âcart-type des valeurs de pixels"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "/raw": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Brut (RAW)",
      "description": "Retourne le buffer brut de l‚Äôimage en base64.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Buffer brut de l'image en base64 (sans pr√©fixe data URL)",
          "content": {
            "application/json": {
              "schema": {
                "type": "string",
                "description": "Buffer brut de l'image encod√© en base64"
              }
            }
          }
        }
      }
    }
  },
  "/resize": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Redimensionner",
      "description": "Redimensionne l‚Äôimage selon la largeur et la hauteur sp√©cifi√©es.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "width",
          "required": true,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "height",
          "required": true,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "options",
          "required": false,
          "schema": {
            "type": "object"
          }
        }
      ]
    }
  },
  "/rotate": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Rotation",
      "description": "Fait pivoter l‚Äôimage (angle optionnel, utilise EXIF si absent).",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "angle",
          "required": false,
          "schema": {
            "type": "number"
          }
        }
      ]
    }
  },
  "/extract": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Rogner",
      "description": "Extrait une portion de l‚Äôimage.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "left",
          "required": true,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "top",
          "required": true,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "width",
          "required": true,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "height",
          "required": true,
          "schema": {
            "type": "number"
          }
        }
      ]
    }
  },
  "/flip": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Miroir vertical",
      "description": "Retourne l‚Äôimage verticalement.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ]
    }
  },
  "/flop": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Miroir horizontal",
      "description": "Retourne l‚Äôimage horizontalement.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ]
    }
  },
  "/autoOrient": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Orientation automatique",
      "description": "Corrige l‚Äôorientation de l‚Äôimage en fonction des m√©tadonn√©es EXIF.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ]
    }
  },
  "/grayscale": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Niveaux de gris",
      "description": "Convertit l‚Äôimage en niveaux de gris.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ]
    }
  },
  "/linear": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Lin√©aire",
      "description": "Applique une transformation lin√©aire √† l‚Äôimage.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "multiplier",
          "required": true,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "offset",
          "required": true,
          "schema": {
            "type": "number"
          }
        }
      ]
    }
  },
  "/threshold": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Seuil",
      "description": "Applique un seuil √† l‚Äôimage pour la convertir en noir et blanc.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "level",
          "required": false,
          "schema": {
            "type": "number",
            "default": 128
          }
        },
        {
          "name": "option",
          "required": false,
          "schema": {
            "type": "object"
          }
        }
      ]
    }
  },
  "/tint": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Teinte",
      "description": "Applique une teinte color√©e √† l‚Äôimage.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "r",
          "required": true,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "g",
          "required": true,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "b",
          "required": true,
          "schema": {
            "type": "number"
          }
        }
      ]
    }
  },
  "/modulate": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Modulation",
      "description": "Ajuste la luminosit√©, la saturation et la teinte.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "brightness",
          "required": false,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "saturation",
          "required": false,
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "hue",
          "required": false,
          "schema": {
            "type": "number"
          }
        }
      ]
    }
  },
  "/blur": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Flou",
      "description": "Applique un flou √† l‚Äôimage.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "radius",
          "required": false,
          "schema": {
            "type": "number"
          }
        }
      ]
    }
  },
  "/sharpen": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Nettet√©",
      "description": "Accentue les contours de l‚Äôimage.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ]
    }
  },
  "/toFormat": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Conversion de format",
      "description": "Convertit l‚Äôimage vers un autre format.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "format",
          "required": true,
          "description": "jpeg, png, webp, avif",
          "schema": {
            "type": "string",
            "enum": [
              "jpeg",
              "png",
              "webp",
              "avif"
            ]
          }
        }
      ]
    }
  },
  "/jpeg": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Exporter en JPEG",
      "description": "Convertit l‚Äôimage en format JPEG avec qualit√© personnalisable.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "quality",
          "required": false,
          "schema": {
            "type": "number",
            "default": 80
          }
        }
      ]
    }
  },
  "/png": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Exporter en PNG",
      "description": "Convertit l‚Äôimage en format PNG avec niveau de compression personnalis√©.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "compressionLevel",
          "required": false,
          "schema": {
            "type": "number",
            "default": 6
          }
        }
      ]
    }
  },
  "/webp": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Exporter en WebP",
      "description": "Convertit l‚Äôimage en format WebP avec qualit√© personnalisable.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "quality",
          "required": false,
          "schema": {
            "type": "number",
            "default": 80
          }
        }
      ]
    }
  },
  "/avif": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Exporter en AVIF",
      "description": "Convertit l‚Äôimage en format AVIF avec qualit√© personnalisable.",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "quality",
          "required": false,
          "schema": {
            "type": "number",
            "default": 50
          }
        }
      ]
    }
  },
  "/composite": {
    "post": {
      "tags": [
        "service"
      ],
      "summary": "Superposition",
      "description": "Superpose une ou plusieurs images (ex. : watermark).",
      "parameters": [
        {
          "name": "content",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "overlays",
          "required": true,
          "description": "Liste d‚Äô√©l√©ments { input (base64), top, left }",
          "schema": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "input": {
                  "type": "string"
                },
                "top": {
                  "type": "number"
                },
                "left": {
                  "type": "number"
                }
              },
              "required": [
                "input",
                "top",
                "left"
              ]
            }
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Image composite avec superpositions en data URL base64",
          "content": {
            "application/json": {
              "schema": {
                "type": "string",
                "description": "Image encod√©e en base64 avec pr√©fixe data URL"
              }
            }
          }
        }
      }
    }
  }
},
"components": {
  "schemas": {
    "ImageResponse": {
      "type": "string",
      "description": "Image encod√©e en base64 avec pr√©fixe data URL"
    }
  }
},
"x-scene-blocks": {}
}