{
  "openapi": "3.0.0",
  "info": {
    "title": "@digipair/skill-sharp",
    "summary": "Image processing",
    "description": "This skill provides advanced image processing functions using the Sharp library.",
    "version": "0.1.0",
    "x-icon": "üñºÔ∏è"
  },
  "paths": {
    "/metadata": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Metadata",
        "description": "Returns image metadata (dimensions, format, EXIF, etc.)",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "description": "Image content as a base64-encoded string",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Image metadata object",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "width": {
                      "type": "number",
                      "description": "Image width in pixels"
                    },
                    "height": {
                      "type": "number",
                      "description": "Image height in pixels"
                    },
                    "channels": {
                      "type": "number",
                      "description": "Number of color channels"
                    },
                    "format": {
                      "type": "string",
                      "description": "Image format (jpeg, png, webp, etc.)"
                    },
                    "space": {
                      "type": "string",
                      "description": "Color space (srgb, rgb16, cmyk, etc.)"
                    },
                    "density": {
                      "type": "number",
                      "description": "Image density in pixels per inch"
                    },
                    "hasProfile": {
                      "type": "boolean",
                      "description": "Whether the image has an embedded color profile"
                    },
                    "hasAlpha": {
                      "type": "boolean",
                      "description": "Whether the image has an alpha channel"
                    }
                  },
                  "example": {
                    "width": 1920,
                    "height": 1080,
                    "channels": 3,
                    "format": "jpeg",
                    "space": "srgb",
                    "density": 72,
                    "hasProfile": false,
                    "hasAlpha": false
                  }
                }
              }
            }
          }
        }
      }
    },
    "/stats": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Stats",
        "description": "Returns image statistics like mean and standard deviation",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Image statistics object",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "channels": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "min": {
                            "type": "number",
                            "description": "Minimum pixel value"
                          },
                          "max": {
                            "type": "number",
                            "description": "Maximum pixel value"
                          },
                          "sum": {
                            "type": "number",
                            "description": "Sum of all pixel values"
                          },
                          "squaresSum": {
                            "type": "number",
                            "description": "Sum of squared pixel values"
                          },
                          "mean": {
                            "type": "number",
                            "description": "Mean pixel value"
                          },
                          "stdev": {
                            "type": "number",
                            "description": "Standard deviation of pixel values"
                          }
                        }
                      }
                    }
                  },
                  "example": {
                    "channels": [
                      {
                        "min": 0,
                        "max": 255,
                        "sum": 12345678,
                        "squaresSum": 987654321,
                        "mean": 128.5,
                        "stdev": 64.2
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    },
    "/raw": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Raw",
        "description": "Returns raw image buffer as base64",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Raw image buffer as base64 string (without data URL prefix)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded raw image buffer",
                  "example": "/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wAARCAA..."
                }
              }
            }
          }
        }
      }
    },
    "/resize": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Resize",
        "description": "Resizes the image",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "width",
            "required": true,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "height",
            "required": true,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "options",
            "required": false,
            "schema": {
              "type": "object"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Resized image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/rotate": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Rotate",
        "description": "Rotates the image (angle optional)",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "angle",
            "required": false,
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Rotated image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/extract": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Extract",
        "description": "Extracts a region from the image",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "left",
            "required": true,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "top",
            "required": true,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "width",
            "required": true,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "height",
            "required": true,
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Extracted image region as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/flip": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Flip",
        "description": "Flips the image vertically",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Vertically flipped image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/flop": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Flop",
        "description": "Flips the image horizontally",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Horizontally flipped image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/autoOrient": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Auto Orient",
        "description": "Automatically orients the image based on EXIF data",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Auto-oriented image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/grayscale": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Grayscale",
        "description": "Converts the image to grayscale",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Grayscale image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/linear": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Linear",
        "description": "Applies a linear transformation to the image",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "multiplier",
            "required": true,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "offset",
            "required": true,
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Linear transformed image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/threshold": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Threshold",
        "description": "Applies a threshold to the image to convert it to black and white.",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "level",
            "required": false,
            "schema": {
              "type": "number",
              "default": 128
            }
          },
          {
            "name": "option",
            "required": false,
            "schema": {
              "type": "object"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Thresholded black and white image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/negate": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Negate",
        "description": "Inverts the image colors",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Color-inverted image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/tint": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Tint",
        "description": "Applies a color tint",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "r",
            "required": true,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "g",
            "required": true,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "b",
            "required": true,
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Color-tinted image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/modulate": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Modulate",
        "description": "Adjusts brightness, saturation and hue",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "brightness",
            "required": false,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "saturation",
            "required": false,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "hue",
            "required": false,
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Modulated image with adjusted brightness/saturation/hue as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/blur": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Blur",
        "description": "Applies a blur effect",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "radius",
            "required": false,
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Blurred image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/sharpen": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Sharpen",
        "description": "Sharpens the image",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Sharpened image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/toFormat": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "To Format",
        "description": "Converts the image to a different format",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "format",
            "required": true,
            "description": "jpeg, png, webp, avif",
            "schema": {
              "type": "string",
              "enum": [
                "jpeg",
                "png",
                "webp",
                "avif"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Format-converted image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with data URL prefix in the specified format",
                  "example": "data:image/webp;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/jpeg": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "JPEG",
        "description": "Exports the image as JPEG",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "quality",
            "required": false,
            "schema": {
              "type": "number",
              "default": 80
            }
          }
        ],
        "responses": {
          "200": {
            "description": "JPEG-encoded image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded JPEG image with data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    },
    "/png": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "PNG",
        "description": "Exports the image as PNG",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "compressionLevel",
            "required": false,
            "schema": {
              "type": "number",
              "default": 6
            }
          }
        ],
        "responses": {
          "200": {
            "description": "PNG-encoded image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded PNG image with data URL prefix",
                  "example": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChAJ/1y8qywAAAABJRU5ErkJggg=="
                }
              }
            }
          }
        }
      }
    },
    "/webp": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "WebP",
        "description": "Exports the image as WebP",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "quality",
            "required": false,
            "schema": {
              "type": "number",
              "default": 80
            }
          }
        ],
        "responses": {
          "200": {
            "description": "WebP-encoded image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded WebP image with data URL prefix",
                  "example": "data:image/webp;base64,UklGRnoAAABXRUJQVlA4IG4AAAAwAQCdASoBAAEAAUAmJZQAA3AA/v8AAAA="
                }
              }
            }
          }
        }
      }
    },
    "/avif": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "AVIF",
        "description": "Exports the image as AVIF",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "quality",
            "required": false,
            "schema": {
              "type": "number",
              "default": 50
            }
          }
        ],
        "responses": {
          "200": {
            "description": "AVIF-encoded image as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded AVIF image with data URL prefix",
                  "example": "data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQ=="
                }
              }
            }
          }
        }
      }
    },
    "/composite": {
      "post": {
        "tags": [
          "service"
        ],
        "summary": "Composite",
        "description": "Overlays other images (e.g. watermark)",
        "parameters": [
          {
            "name": "content",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "overlays",
            "required": true,
            "description": "Array of { input (base64), top, left }",
            "schema": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "input": {
                    "type": "string"
                  },
                  "top": {
                    "type": "number"
                  },
                  "left": {
                    "type": "number"
                  }
                },
                "required": [
                  "input",
                  "top",
                  "left"
                ]
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Composite image with overlays as base64-encoded data URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "description": "Base64-encoded image with overlays applied and data URL prefix",
                  "example": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH..."
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {}
  },
  "x-scene-blocks": {}
}