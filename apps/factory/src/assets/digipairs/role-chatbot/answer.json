{
  "description": "Génération d'une réponse pour l'utilisateur via le chatbot.",
  "library": "@digipair/skill-factory",
  "element": "task",
  "metadata": {},
  "properties": {
    "execute": [
      {
        "library": "@digipair/skill-basic",
        "element": "setVariable",
        "properties": {
          "name": "userMessageId",
          "execute": [
            {
              "library": "@digipair/skill-basic",
              "element": "transform",
              "properties": {
                "value": "FEEL: if requester.request.body.prompt != null and requester.request.body.prompt != \"\" then getTime() else null"
              }
            }
          ]
        }
      },
      {
        "library": "@digipair/skill-basic",
        "element": "setVariable",
        "properties": {
          "name": "boost",
          "value": {
            "reasoning": "FEEL: requester.request.reasoning",
            "step": "FEEL: request.body.boost[1].step",
            "prompt": "FEEL: request.body.boost[1].prompt",
            "required": "FEEL: request.body.boost[1].required",
            "selector": "FEEL: request.body.boost[1].selector",
            "url": "FEEL: request.body.boost[1].url",
            "inputs": "FEEL: request.body.boost[1].inputs",
            "context": "FEEL: requester.request.body.context"
          }
        },
        "conditions": {
          "if": "FEEL: request.body.boost[1]"
        }
      },
      {
        "library": "@digipair/skill-basic",
        "element": "transform",
        "properties": {
          "value": {
            "uuid": "FEEL: previous[1]",
            "parent_history": "FEEL: variables.userMessageId",
            "parent_conversation": "FEEL: requester.request.body.parent_conversation",
            "assistant": "{{request.body.assistant}}",
            "command": "FEEL: if request.body.command then request.body.command else []",
            "boost": "FEEL: variables.boost",
            "boosts": "FEEL: request.body.boosts",
            "sources": "FEEL: request.body.sources",
            "files": "FEEL: request.body.files",
            "logs": "FEEL: request.body.logs"
          }
        }
      },
      {
        "library": "@digipair/skill-factory",
        "element": "execute",
        "properties": {
          "execute": [
            {
              "library": "@digipair/skill-chatbot",
              "element": "answer",
              "properties": {
                "assistant": "FEEL: data.assistant",
                "boosts": "FEEL: data.boosts",
                "logs": "FEEL: data.logs",
                "parent_conversation": "FEEL: data.parent_conversation",
                "parent_history": "FEEL: data.parent_history",
                "sources": "FEEL: data.sources",
                "files": "FEEL: data.files",
                "uuid": "FEEL: data.uuid",
                "boost": "FEEL: data.boost",
                "command": "FEEL: data.command"
              }
            }
          ],
          "context": "FEEL: context put(requester, \"data\", previous)"
        }
      }
    ]
  },
  "pins": []
}